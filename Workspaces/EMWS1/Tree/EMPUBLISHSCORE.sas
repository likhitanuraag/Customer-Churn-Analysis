****************************************************************;
******             DECISION TREE SCORING CODE             ******;
****************************************************************;
 
******         LENGTHS OF NEW CHARACTER VARIABLES         ******;
LENGTH I_Churned  $    3;
LENGTH U_Churned  $    3;
LENGTH _WARN_  $    4;
 
******              LABELS FOR NEW VARIABLES              ******;
label _NODE_ = 'Node' ;
label _LEAF_ = 'Leaf' ;
label P_ChurnedYes = 'Predicted: Churned=Yes' ;
label P_ChurnedNo = 'Predicted: Churned=No' ;
label Q_ChurnedYes = 'Unadjusted P: Churned=Yes' ;
label Q_ChurnedNo = 'Unadjusted P: Churned=No' ;
label V_ChurnedYes = 'Validated: Churned=Yes' ;
label V_ChurnedNo = 'Validated: Churned=No' ;
label I_Churned = 'Into: Churned' ;
label U_Churned = 'Unnormalized Into: Churned' ;
label _WARN_ = 'Warnings' ;
 
 
******      TEMPORARY VARIABLES FOR FORMATTED VALUES      ******;
LENGTH _ARBFMT_3 $      3; DROP _ARBFMT_3;
_ARBFMT_3 = ' '; /* Initialize to avoid warning. */
 
 
******             ASSIGN OBSERVATION TO NODE             ******;
IF  NOT MISSING(Age_Zscore ) AND
      0.34117704268097 <= Age_Zscore  THEN DO;
  IF  NOT MISSING(IsActiveMemberNo ) AND
                     0.5 <= IsActiveMemberNo  THEN DO;
    IF  NOT MISSING(Age_Zscore ) AND
          0.91326978654266 <= Age_Zscore  THEN DO;
      IF  NOT MISSING(NumOfProducts ) AND
                         1.5 <= NumOfProducts  THEN DO;
        IF  NOT MISSING(NumOfProducts ) AND
                           2.5 <= NumOfProducts  THEN DO;
          _NODE_  =                   37;
          _LEAF_  =                   18;
          P_ChurnedYes  =                    1;
          P_ChurnedNo  =                    0;
          Q_ChurnedYes  =                    1;
          Q_ChurnedNo  =                    0;
          V_ChurnedYes  =                    1;
          V_ChurnedNo  =                    0;
          I_Churned  = 'YES' ;
          U_Churned  = 'Yes' ;
          END;
        ELSE DO;
          IF  NOT MISSING(Age_Zscore ) AND
            Age_Zscore  <      1.1993161584735 THEN DO;
            _NODE_  =                   42;
            _LEAF_  =                   16;
            P_ChurnedYes  =                 0.32;
            P_ChurnedNo  =                 0.68;
            Q_ChurnedYes  =                 0.32;
            Q_ChurnedNo  =                 0.68;
            V_ChurnedYes  =     0.21428571428571;
            V_ChurnedNo  =     0.78571428571428;
            I_Churned  = 'NO' ;
            U_Churned  = 'No' ;
            END;
          ELSE DO;
            _NODE_  =                   43;
            _LEAF_  =                   17;
            P_ChurnedYes  =     0.76190476190476;
            P_ChurnedNo  =     0.23809523809523;
            Q_ChurnedYes  =     0.76190476190476;
            Q_ChurnedNo  =     0.23809523809523;
            V_ChurnedYes  =     0.58823529411764;
            V_ChurnedNo  =     0.41176470588235;
            I_Churned  = 'YES' ;
            U_Churned  = 'Yes' ;
            END;
          END;
        END;
      ELSE DO;
        _NODE_  =                   24;
        _LEAF_  =                   15;
        P_ChurnedYes  =     0.87373737373737;
        P_ChurnedNo  =     0.12626262626262;
        Q_ChurnedYes  =     0.87373737373737;
        Q_ChurnedNo  =     0.12626262626262;
        V_ChurnedYes  =     0.85393258426966;
        V_ChurnedNo  =     0.14606741573033;
        I_Churned  = 'YES' ;
        U_Churned  = 'Yes' ;
        END;
      END;
    ELSE DO;
      IF  NOT MISSING(NumOfProducts ) AND
                         1.5 <= NumOfProducts  THEN DO;
        _NODE_  =                   23;
        _LEAF_  =                   14;
        P_ChurnedYes  =     0.30246913580246;
        P_ChurnedNo  =     0.69753086419753;
        Q_ChurnedYes  =     0.30246913580246;
        Q_ChurnedNo  =     0.69753086419753;
        V_ChurnedYes  =                 0.25;
        V_ChurnedNo  =                 0.75;
        I_Churned  = 'NO' ;
        U_Churned  = 'No' ;
        END;
      ELSE DO;
        _NODE_  =                   22;
        _LEAF_  =                   13;
        P_ChurnedYes  =                0.552;
        P_ChurnedNo  =                0.448;
        Q_ChurnedYes  =                0.552;
        Q_ChurnedNo  =                0.448;
        V_ChurnedYes  =     0.61363636363636;
        V_ChurnedNo  =     0.38636363636363;
        I_Churned  = 'YES' ;
        U_Churned  = 'Yes' ;
        END;
      END;
    END;
  ELSE DO;
    IF  NOT MISSING(NumOfProducts ) AND
                       2.5 <= NumOfProducts  THEN DO;
      _NODE_  =                   13;
      _LEAF_  =                   12;
      P_ChurnedYes  =     0.94871794871794;
      P_ChurnedNo  =     0.05128205128205;
      Q_ChurnedYes  =     0.94871794871794;
      Q_ChurnedNo  =     0.05128205128205;
      V_ChurnedYes  =     0.92857142857142;
      V_ChurnedNo  =     0.07142857142857;
      I_Churned  = 'YES' ;
      U_Churned  = 'Yes' ;
      END;
    ELSE DO;
      IF  NOT MISSING(NumOfProducts ) AND
                         1.5 <= NumOfProducts  THEN DO;
        _NODE_  =                   21;
        _LEAF_  =                   11;
        P_ChurnedYes  =     0.11475409836065;
        P_ChurnedNo  =     0.88524590163934;
        Q_ChurnedYes  =     0.11475409836065;
        Q_ChurnedNo  =     0.88524590163934;
        V_ChurnedYes  =     0.12883435582822;
        V_ChurnedNo  =     0.87116564417177;
        I_Churned  = 'NO' ;
        U_Churned  = 'No' ;
        END;
      ELSE DO;
        IF  NOT MISSING(Age_Zscore ) AND
              1.77140890233518 <= Age_Zscore  THEN DO;
          _NODE_  =                   31;
          _LEAF_  =                   10;
          P_ChurnedYes  =     0.14473684210526;
          P_ChurnedNo  =     0.85526315789473;
          Q_ChurnedYes  =     0.14473684210526;
          Q_ChurnedNo  =     0.85526315789473;
          V_ChurnedYes  =     0.19607843137254;
          V_ChurnedNo  =     0.80392156862745;
          I_Churned  = 'NO' ;
          U_Churned  = 'No' ;
          END;
        ELSE DO;
          _NODE_  =                   30;
          _LEAF_  =                    9;
          P_ChurnedYes  =     0.41806020066889;
          P_ChurnedNo  =      0.5819397993311;
          Q_ChurnedYes  =     0.41806020066889;
          Q_ChurnedNo  =      0.5819397993311;
          V_ChurnedYes  =     0.38518518518518;
          V_ChurnedNo  =     0.61481481481481;
          I_Churned  = 'NO' ;
          U_Churned  = 'No' ;
          END;
        END;
      END;
    END;
  END;
ELSE DO;
  IF  NOT MISSING(NumOfProducts ) AND
                     2.5 <= NumOfProducts  THEN DO;
    IF  NOT MISSING(Age_Zscore ) AND
         -0.13556691053708 <= Age_Zscore  THEN DO;
      _NODE_  =                   11;
      _LEAF_  =                    8;
      P_ChurnedYes  =     0.83333333333333;
      P_ChurnedNo  =     0.16666666666666;
      Q_ChurnedYes  =     0.83333333333333;
      Q_ChurnedNo  =     0.16666666666666;
      V_ChurnedYes  =     0.86666666666666;
      V_ChurnedNo  =     0.13333333333333;
      I_Churned  = 'YES' ;
      U_Churned  = 'Yes' ;
      END;
    ELSE DO;
      _NODE_  =                   10;
      _LEAF_  =                    7;
      P_ChurnedYes  =      0.6078431372549;
      P_ChurnedNo  =     0.39215686274509;
      Q_ChurnedYes  =      0.6078431372549;
      Q_ChurnedNo  =     0.39215686274509;
      V_ChurnedYes  =     0.65217391304347;
      V_ChurnedNo  =     0.34782608695652;
      I_Churned  = 'YES' ;
      U_Churned  = 'Yes' ;
      END;
    END;
  ELSE DO;
    IF  NOT MISSING(NumOfProducts ) AND
      NumOfProducts  <                  1.5 THEN DO;
      IF  NOT MISSING(IsActiveMemberNo ) AND
                         0.5 <= IsActiveMemberNo  THEN DO;
        IF  NOT MISSING(Age_Zscore ) AND
             -0.13556691053708 <= Age_Zscore  THEN DO;
          _NODE_  =                   29;
          _LEAF_  =                    4;
          P_ChurnedYes  =     0.29411764705882;
          P_ChurnedNo  =     0.70588235294117;
          Q_ChurnedYes  =     0.29411764705882;
          Q_ChurnedNo  =     0.70588235294117;
          V_ChurnedYes  =      0.3095238095238;
          V_ChurnedNo  =     0.69047619047619;
          I_Churned  = 'NO' ;
          U_Churned  = 'No' ;
          END;
        ELSE DO;
          _NODE_  =                   28;
          _LEAF_  =                    3;
          P_ChurnedYes  =     0.16108452950558;
          P_ChurnedNo  =     0.83891547049441;
          Q_ChurnedYes  =     0.16108452950558;
          Q_ChurnedNo  =     0.83891547049441;
          V_ChurnedYes  =     0.18181818181818;
          V_ChurnedNo  =     0.81818181818181;
          I_Churned  = 'NO' ;
          U_Churned  = 'No' ;
          END;
        END;
      ELSE DO;
        IF  NOT MISSING(GenderFemale ) AND
                           0.5 <= GenderFemale  THEN DO;
          _NODE_  =                   27;
          _LEAF_  =                    2;
          P_ChurnedYes  =     0.15776081424936;
          P_ChurnedNo  =     0.84223918575063;
          Q_ChurnedYes  =     0.15776081424936;
          Q_ChurnedNo  =     0.84223918575063;
          V_ChurnedYes  =                 0.16;
          V_ChurnedNo  =                 0.84;
          I_Churned  = 'NO' ;
          U_Churned  = 'No' ;
          END;
        ELSE DO;
          _NODE_  =                   26;
          _LEAF_  =                    1;
          P_ChurnedYes  =     0.09140767824497;
          P_ChurnedNo  =     0.90859232175502;
          Q_ChurnedYes  =     0.09140767824497;
          Q_ChurnedNo  =     0.90859232175502;
          V_ChurnedYes  =     0.11004784688995;
          V_ChurnedNo  =     0.88995215311004;
          I_Churned  = 'NO' ;
          U_Churned  = 'No' ;
          END;
        END;
      END;
    ELSE DO;
      IF  NOT MISSING(GenderFemale ) AND
                         0.5 <= GenderFemale  THEN DO;
        _NODE_  =                   19;
        _LEAF_  =                    6;
        P_ChurnedYes  =     0.06153846153846;
        P_ChurnedNo  =     0.93846153846153;
        Q_ChurnedYes  =     0.06153846153846;
        Q_ChurnedNo  =     0.93846153846153;
        V_ChurnedYes  =     0.05962059620596;
        V_ChurnedNo  =     0.94037940379403;
        I_Churned  = 'NO' ;
        U_Churned  = 'No' ;
        END;
      ELSE DO;
        _NODE_  =                   18;
        _LEAF_  =                    5;
        P_ChurnedYes  =     0.02966507177033;
        P_ChurnedNo  =     0.97033492822966;
        Q_ChurnedYes  =     0.02966507177033;
        Q_ChurnedNo  =     0.97033492822966;
        V_ChurnedYes  =                 0.02;
        V_ChurnedNo  =                 0.98;
        I_Churned  = 'NO' ;
        U_Churned  = 'No' ;
        END;
      END;
    END;
  END;
 
****************************************************************;
******          END OF DECISION TREE SCORING CODE         ******;
****************************************************************;
 
drop _LEAF_;
